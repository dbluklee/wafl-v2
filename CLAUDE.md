# WAFL í”„ë¡œì íŠ¸ ê°œë°œ ì§„í–‰ ìƒí™©

> ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-10-07 (LLM ë‹¤êµ­ì–´ ì‘ë‹µ ë° UI ë°°ì§€ ê°œì„ )
>
> ì´ ë¬¸ì„œëŠ” Claude Codeì™€ì˜ ì‘ì—… ì—°ì†ì„±ì„ ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ ë¬¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**WAFL**: ë§¤ì¥ìš© RAG ê¸°ë°˜ AI ì±—ë´‡ ì‹œìŠ¤í…œ

### ì‹œìŠ¤í…œ êµ¬ì„±
```
wafl/
â”œâ”€â”€ web-server/          # ì›¹ ì„œë²„
â”œâ”€â”€ scraping-server/     # ìŠ¤í¬ë˜í•‘ ì„œë²„
â”œâ”€â”€ rag-server/          # RAG + LLM ì„œë²„ (ë©”ì¸ ì‘ì—… ì˜ì—­)
â””â”€â”€ CLAUDE.md           # ì´ ë¬¸ì„œ
```

---

## âœ… í˜„ì¬ê¹Œì§€ êµ¬í˜„ëœ ê¸°ëŠ¥

### 1. RAG ì‹œìŠ¤í…œ (ì™„ë£Œ)
- **ìœ„ì¹˜**: `rag-server/`
- **êµ¬í˜„ ë‚´ìš©**:
  - âœ… ë¬¸ì„œ ì„ë² ë”© ë° ë²¡í„° ì €ì¥ (Milvus)
  - âœ… ì˜ë¯¸ ê¸°ë°˜ ë¬¸ì„œ ê²€ìƒ‰
  - âœ… RAG Pipeline (`rag_pipeline.py`)
  - âœ… ë¬¸ì„œ ìë™ ìƒì„± (`document_generator.py`)

### 2. Agent ì‹œìŠ¤í…œ (ì™„ë£Œ - ë°±ì—…)
- **ìœ„ì¹˜**: `rag-server/agent.py`
- **ì—­í• **: RAG í•„ìš” ì—¬ë¶€ íŒë‹¨ (YES/NO)
- **ìƒíƒœ**: ë°±ì—…ìš©ìœ¼ë¡œ ìœ ì§€ (ìƒˆ ë¼ìš°í„°ë¡œ ëŒ€ì²´ë¨)
- **ëª¨ë¸**:
  - Agent: Kanana (RAG íŒë‹¨)
  - Main LLM: Gemma3 (ì‘ë‹µ ìƒì„±)

### 3. ëŒ€í™” ì €ì¥ ì‹œìŠ¤í…œ (ì™„ë£Œ)
- **ë¹„ë™ê¸° ë¡œê¹…**: Redis Queue ê¸°ë°˜
- **ì•”í˜¸í™”**: AES-256-GCM
- **íŒŒì¼**:
  - `conversation_service.py`: ëŒ€í™” ê´€ë¦¬
  - `conversation_logger.py`: ë¹„ë™ê¸° ë¡œê¹…
  - `encryption_utils.py`: ì•”í˜¸í™”

### 4. API ì—”ë“œí¬ì¸íŠ¸ (ì™„ë£Œ)
- **ìœ„ì¹˜**: `rag-server/main.py`
- **ì£¼ìš” API**:
  - `POST /api/chat`: ì±„íŒ… (ë¼ìš°íŒ… ì‹œìŠ¤í…œ í†µí•©)
  - `POST /api/generate-documents`: ë¬¸ì„œ ìƒì„±
  - `POST /api/index-documents`: ë¬¸ì„œ ì¸ë±ì‹±
  - `GET /api/conversations/{uuid}`: ëŒ€í™” ì¡°íšŒ
  - `GET /api/stores/{id}/conversation-statistics`: í†µê³„

### 5. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
- **í…Œì´ë¸”**:
  - `stores`: ë§¤ì¥ ì •ë³´
  - `rag_documents`: RAG ë¬¸ì„œ
  - `conversations`: ëŒ€í™” ì„¸ì…˜
  - `conversation_messages`: ëŒ€í™” ë©”ì‹œì§€

### 6. â­ LLM íˆ´ í˜¸ì¶œ ì ì‘í˜• ë¼ìš°íŒ… ì‹œìŠ¤í…œ (ì™„ë£Œ)
- **ìœ„ì¹˜**: `rag-server/router.py`, `tools.py`, `tool_executor.py`
- **êµ¬í˜„ ë‚ ì§œ**: 2025-10-07
- **ìƒì„¸ ë‚´ìš©**: ì•„ë˜ ì„¹ì…˜ ì°¸ì¡°

### 7. ğŸŒ ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ ë° ë‹¤êµ­ì–´ ì§€ì› (ì™„ë£Œ)
- **ìœ„ì¹˜**: `rag-server/tools.py` (SetLanguageTool), `templates/chat.html`
- **êµ¬í˜„ ë‚ ì§œ**: 2025-10-07
- **ì§€ì› ì–¸ì–´**: í•œêµ­ì–´, ì˜ì–´, ì¤‘êµ­ì–´, ì¼ë³¸ì–´
- **ì£¼ìš” ê¸°ëŠ¥**:
  - âœ… ì±—ë´‡ ëª…ë ¹ìœ¼ë¡œ ì–¸ì–´ ë³€ê²½ (ì˜ˆ: "plz speak english")
  - âœ… UI ë²„íŠ¼ìœ¼ë¡œ ì–¸ì–´ ë³€ê²½
  - âœ… ì „ì²´ UI ë‹¤êµ­ì–´ ì§€ì› (í—¤ë”, ë²„íŠ¼, ë©”ì‹œì§€ ë“±)
  - âœ… ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ìœ ì§€)
  - âœ… í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ìë™ ì—°ë™
- **ìƒì„¸ ë‚´ìš©**: ì•„ë˜ ì„¹ì…˜ ì°¸ì¡°

### 8. ğŸ¤– LLM ë‹¤êµ­ì–´ ì‘ë‹µ ë° UI ë°°ì§€ ê°œì„  (ì™„ë£Œ)
- **ìœ„ì¹˜**: `rag-server/main.py`, `rag_pipeline.py`, `templates/chat.html`
- **êµ¬í˜„ ë‚ ì§œ**: 2025-10-07
- **ì£¼ìš” ê¸°ëŠ¥**:
  - âœ… LLMì´ í”„ë¡ íŠ¸ì—”ë“œ ì–¸ì–´ ì„¤ì •ì— ë”°ë¼ í•´ë‹¹ ì–¸ì–´ë¡œ ì‘ë‹µ
  - âœ… í”„ë¡¬í”„íŠ¸ ê°„ì†Œí™” (ë‹¨ì¼ ì˜ì–´ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ)
  - âœ… ì±„íŒ… UIì— íˆ´ ë°°ì§€ ì¶”ê°€ (ì¼ë°˜/RAG/íˆ´ êµ¬ë¶„)
  - âœ… 4ê°œ ì–¸ì–´ ëª¨ë‘ ë°°ì§€ í…ìŠ¤íŠ¸ ì§€ì›
- **ìƒì„¸ ë‚´ìš©**: ì•„ë˜ ì„¹ì…˜ ì°¸ì¡°

---

## ğŸ‰ ìµœê·¼ ì™„ë£Œëœ ì‘ì—…: LLM íˆ´ í˜¸ì¶œ ì ì‘í˜• ë¼ìš°íŒ… ì‹œìŠ¤í…œ

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë³€í™”

#### ì´ì „ ì‹œìŠ¤í…œ
```
ì‚¬ìš©ì ì§ˆë¬¸ â†’ Agent (Kanana) â†’ RAG íŒë‹¨ (YES/NO)
                                â†“ YES: RAG Pipeline â†’ Gemma3
                                â†“ NO: ì¼ë°˜ ëŒ€í™” â†’ Gemma3
```

#### ìƒˆ ì‹œìŠ¤í…œ (í˜„ì¬)
```
ì‚¬ìš©ì ì§ˆë¬¸ â†’ IntelligentRouter (Kanana) â†’ 3ê°€ì§€ ê²½ë¡œ ê²°ì • (JSON)
                                            â†“
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â†“                   â†“                   â†“
                    TOOL_CALL           RAG_QUERY           SIMPLE_QA
                        â†“                   â†“                   â†“
                    íˆ´ ì‹¤í–‰              RAG ê²€ìƒ‰            Gemma3 ì§ì ‘
                        â†“                   â†“                   â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â†“                   â†“
            â†“                       â†“      â†“                   â†“
    Self-Contained          LLM-Interpreted                    â†“
    (ì¦‰ì‹œ ì‘ë‹µ)              (Gemma3 í•´ì„)                     â†“
            â†“                       â†“      â†“                   â†“
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
                    ìµœì¢… ì‘ë‹µ
```

### êµ¬í˜„ëœ íŒŒì¼

#### 1. `tools.py` (ì‹ ê·œ - 470ì¤„)
**ì—­í• **: ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  íˆ´ ì •ì˜ ë° ê´€ë¦¬

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸**:
- `BaseTool`: ëª¨ë“  íˆ´ì˜ ì¶”ìƒ ë² ì´ìŠ¤ í´ë˜ìŠ¤
  - `name`: íˆ´ ì´ë¦„
  - `description`: íˆ´ ì„¤ëª…
  - `tool_type`: "Self-Contained" ë˜ëŠ” "LLM-Interpreted"
  - `parameters`: íŒŒë¼ë¯¸í„° ìŠ¤í‚¤ë§ˆ
  - `execute(**kwargs)`: íˆ´ ì‹¤í–‰ ë©”ì„œë“œ

**êµ¬í˜„ëœ íˆ´ (7ê°œ)**:

**ìì²´ ì²˜ë¦¬ íˆ´ (Self-Contained) - 4ê°œ**:
1. **SetLanguageTool**: ì–¸ì–´ ì„¤ì • ë³€ê²½
   - íŒŒë¼ë¯¸í„°: `language` (ko, en, ja, zh)
   - ì‘ë‹µ ì˜ˆ: "ì–¸ì–´ê°€ í•œêµ­ì–´(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤"

2. **OrderMenuTool**: ë©”ë‰´ ì£¼ë¬¸
   - íŒŒë¼ë¯¸í„°: `menu` (í•„ìˆ˜), `quantity` (ì„ íƒ), `options` (ì„ íƒ)
   - ì‘ë‹µ ì˜ˆ: "ê¹€ì¹˜ì°Œê°œ 1ê°œ ì£¼ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"

3. **NavigateToTool**: UI ë„¤ë¹„ê²Œì´ì…˜
   - íŒŒë¼ë¯¸í„°: `destination` (menu, order_history, settings, etc.)
   - ì‘ë‹µ ì˜ˆ: "ë©”ë‰´ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤"

4. **ApplyFilterTool**: í•„í„° ì ìš©
   - íŒŒë¼ë¯¸í„°: `filter_type`, `filter_value`
   - ì‘ë‹µ ì˜ˆ: "ì¹´í…Œê³ ë¦¬ í•„í„°ê°€ 'í•œì‹'(ìœ¼)ë¡œ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤"

**LLM í•´ì„ íˆ´ (LLM-Interpreted) - 3ê°œ**:
1. **GetSalesDataTool**: ë§¤ì¶œ ë°ì´í„° ì¡°íšŒ
   - íŒŒë¼ë¯¸í„°: `date` (today/yesterday/YYYY-MM-DD), `period` (daily/weekly/monthly)
   - ë”ë¯¸ ë°ì´í„°: ì´ ë§¤ì¶œ, ì£¼ë¬¸ ìˆ˜, í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡, ì „ì¼ ëŒ€ë¹„ ë“±
   - Gemma3ê°€ ìì—°ì–´ë¡œ í•´ì„

2. **GetOrderStatisticsTool**: ì£¼ë¬¸ í†µê³„ ì¡°íšŒ
   - íŒŒë¼ë¯¸í„°: `period`, `stat_type` (menu_ranking/time_distribution/category)
   - ë”ë¯¸ ë°ì´í„°: ë©”ë‰´ ìˆœìœ„, ì‹œê°„ëŒ€ë³„ ë¶„í¬ ë“±
   - Gemma3ê°€ ìì—°ì–´ë¡œ í•´ì„

3. **AnalyzeTrendsTool**: íŠ¸ë Œë“œ ë¶„ì„
   - íŒŒë¼ë¯¸í„°: `analysis_type` (sales/menu/customer), `period` (week/month/quarter)
   - ë”ë¯¸ ë°ì´í„°: íŠ¸ë Œë“œ ë°©í–¥, ì¸ì‚¬ì´íŠ¸, ê¶Œì¥ì‚¬í•­ ë“±
   - Gemma3ê°€ ìì—°ì–´ë¡œ í•´ì„

**ToolRegistry**:
- ëª¨ë“  íˆ´ì„ ê´€ë¦¬í•˜ëŠ” ì¤‘ì•™ ì €ì¥ì†Œ
- ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì „ì—­ ì ‘ê·¼ (`get_tool_registry()`)
- íˆ´ ë“±ë¡, ì¡°íšŒ, íƒ€ì…ë³„ í•„í„°ë§ ê¸°ëŠ¥

**í˜„ì¬ êµ¬í˜„ ìƒíƒœ**:
- âœ… ëª¨ë“  íˆ´ì€ ì‹¤ì œ ë™ì‘ ì—†ì´ **ì‹¤í–‰ ë…¸í‹°ë§Œ í‘œì‹œ**
- âœ… í˜•ì‹: `"âœ… [íˆ´ ì‹¤í–‰] {tool_name} - {params}"`
- â³ ì‹¤ì œ ë™ì‘ êµ¬í˜„ì€ ì¶”í›„ ì§„í–‰ (DB ì—°ë™, API í˜¸ì¶œ ë“±)

#### 2. `tool_executor.py` (ì‹ ê·œ - 200ì¤„)
**ì—­í• **: íˆ´ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ íˆ´ì„ ê°€ì ¸ì™€ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ë°˜í™˜

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸**:
- `ToolExecutor`: íˆ´ ì‹¤í–‰ ë° ê²°ê³¼ ì²˜ë¦¬ í´ë˜ìŠ¤
  - `execute_tool(tool_name, tool_params)`: íˆ´ ì‹¤í–‰
  - `validate_params(tool, params)`: íŒŒë¼ë¯¸í„° ê²€ì¦
  - `get_available_tools()`: ì‚¬ìš© ê°€ëŠ¥í•œ íˆ´ ëª©ë¡ ì¡°íšŒ

**ì‹¤í–‰ í”„ë¡œì„¸ìŠ¤**:
1. íˆ´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
2. íˆ´ ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
3. íŒŒë¼ë¯¸í„° ê²€ì¦:
   - í•„ìˆ˜ íŒŒë¼ë¯¸í„° í™•ì¸
   - enum ê°’ ê²€ì¦
   - íƒ€ì… ê²€ì¦
4. íˆ´ ì‹¤í–‰
5. ê²°ê³¼ ë°˜í™˜ ë˜ëŠ” ì—ëŸ¬ ì²˜ë¦¬

**ì‘ë‹µ í˜•ì‹**:
```json
{
  "success": true,
  "notification": "âœ… [íˆ´ ì‹¤í–‰] order_menu - ê¹€ì¹˜ì°Œê°œ 1ê°œ",
  "result": {
    "menu": "ê¹€ì¹˜ì°Œê°œ",
    "quantity": 1,
    "message": "ê¹€ì¹˜ì°Œê°œ 1ê°œ ì£¼ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤",
    "order_id": "ORDER_20251007143045"
  },
  "executed_at": "2025-10-07T14:30:45.123456",
  "tool_name": "order_menu",
  "tool_type": "Self-Contained"
}
```

**ì—ëŸ¬ í•¸ë“¤ë§**:
- íˆ´ ì—†ìŒ: "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íˆ´ì…ë‹ˆë‹¤"
- íŒŒë¼ë¯¸í„° ì˜¤ë¥˜: êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€
- ì‹¤í–‰ ì˜¤ë¥˜: ìƒì„¸ ë¡œê¹… ë° ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€

#### 3. `router.py` (ì‹ ê·œ - 350ì¤„)
**ì—­í• **: Kanana ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„ ë° ìµœì  ê²½ë¡œ ê²°ì •

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸**:
- `IntelligentRouter`: ì§€ëŠ¥í˜• ë¼ìš°í„° í´ë˜ìŠ¤
  - `route(user_message)`: ê²½ë¡œ ê²°ì • ë©”ì¸ ë©”ì„œë“œ
  - `_create_routing_prompt(user_message)`: ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ ìƒì„±
  - `_parse_routing_response(raw_response)`: JSON íŒŒì‹± ë° ê²€ì¦
  - `_heuristic_routing(user_message)`: íœ´ë¦¬ìŠ¤í‹± ê¸°ë°˜ fallback

**ë¼ìš°íŒ… í”„ë¡¬í”„íŠ¸ êµ¬ì¡°**:
```
ì‚¬ìš©ì ì§ˆë¬¸: "{user_message}"

3ê°€ì§€ ê²½ë¡œ ì¤‘ ì„ íƒ:
1. TOOL_CALL - ì‚¬ìš© ê°€ëŠ¥í•œ íˆ´ ëª©ë¡ ì œê³µ
2. RAG_QUERY - ë§¤ì¥ ë¬¸ì„œ ê²€ìƒ‰ í•„ìš” ì¡°ê±´ ëª…ì‹œ
3. SIMPLE_QA - ì¼ë°˜ ëŒ€í™” ì¡°ê±´ ëª…ì‹œ

ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€
ì˜ˆì‹œ ì œê³µ (ê° ê²½ë¡œë³„ 5ê°œ)
```

**JSON ì‘ë‹µ í˜•ì‹**:
```json
// TOOL_CALL
{
  "route": "TOOL_CALL",
  "tool_name": "order_menu",
  "tool_params": {"menu": "ê¹€ì¹˜ì°Œê°œ", "quantity": 1},
  "tool_type": "Self-Contained",
  "confidence": 0.98,
  "reasoning": "ë©”ë‰´ ì£¼ë¬¸ ìš”ì²­"
}

// RAG_QUERY
{
  "route": "RAG_QUERY",
  "query": "ì˜ì—…ì‹œê°„ ì•Œë ¤ì¤˜",
  "confidence": 0.95,
  "reasoning": "ë§¤ì¥ ì •ë³´ ì¡°íšŒ í•„ìš”"
}

// SIMPLE_QA
{
  "route": "SIMPLE_QA",
  "query": "ì•ˆë…•í•˜ì„¸ìš”",
  "confidence": 0.99,
  "reasoning": "ì¼ë°˜ ì¸ì‚¬"
}
```

**ì•ˆì „ì¥ì¹˜**:
1. **JSON íŒŒì‹± ì‹¤íŒ¨ ì‹œ**: íœ´ë¦¬ìŠ¤í‹± ê¸°ë°˜ ë¼ìš°íŒ…
   - íˆ´ í‚¤ì›Œë“œ ë§¤ì¹­ (ì£¼ë¬¸, ì–¸ì–´, ë§¤ì¶œ ë“±)
   - RAG í‚¤ì›Œë“œ ë§¤ì¹­ (ë©”ë‰´, ê°€ê²©, ì˜ì—…ì‹œê°„ ë“±)
   - ê¸°ë³¸ê°’: SIMPLE_QA

2. **ì—ëŸ¬ ë°œìƒ ì‹œ**: SIMPLE_QAë¡œ fallback
   - ì‚¬ìš©ìëŠ” ì •ìƒ ì‘ë‹µ ë°›ìŒ
   - ë¡œê·¸ì— ìƒì„¸ ì˜¤ë¥˜ ê¸°ë¡

#### 4. `main.py` (ìˆ˜ì •)
**ë³€ê²½ ë‚´ìš©**: ë¼ìš°í„° ê¸°ë°˜ 3ê°€ì§€ ê²½ë¡œ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€

**ìƒˆë¡œ ì¶”ê°€ëœ í•¨ìˆ˜**:

1. **`interpret_tool_result_with_llm(user_message, tool_name, tool_result)`**:
   - LLM-Interpreted íˆ´ ê²°ê³¼ë¥¼ Gemma3ë¡œ ìì—°ì–´ í•´ì„
   - í”„ë¡¬í”„íŠ¸:
     ```
     ì†ë‹˜ ì§ˆë¬¸: {user_message}
     ì‹¤í–‰ëœ ê¸°ëŠ¥: {tool_name}
     ì¡°íšŒ ê²°ê³¼: {tool_result JSON}

     ë‹µë³€ ê·œì¹™:
     - 50ì ì´ë‚´ ê°„ê²°
     - ë°ì´í„° í•µì‹¬ë§Œ ì „ë‹¬
     - ìˆ«ì ì½ê¸° ì‰½ê²Œ í¬ë§· (1500000 â†’ 150ë§Œì›)
     - íŠ¸ë Œë“œ/ì¸ì‚¬ì´íŠ¸ ê°„ë‹¨íˆ ì–¸ê¸‰
     ```

2. **`simple_chat_with_llm(user_message)`**:
   - SIMPLE_QA ê²½ë¡œì—ì„œ Gemma3 ì§ì ‘ í˜¸ì¶œ
   - ì¼ë°˜ ëŒ€í™” ì²˜ë¦¬ (50ì ì œí•œ)

**ìˆ˜ì •ëœ `/api/chat` ì—”ë“œí¬ì¸íŠ¸**:
```python
@app.post("/api/chat")
async def chat(request: ChatRequest, http_request: Request):
    # 1. ë¼ìš°í„°ë¡œ ê²½ë¡œ ê²°ì •
    route_decision = await router.route(request.message)

    # 2. ê²½ë¡œë³„ ì²˜ë¦¬
    if route_decision["route"] == "TOOL_CALL":
        # íˆ´ ì‹¤í–‰
        tool_result = await tool_executor.execute_tool(...)

        if tool_type == "Self-Contained":
            # ì¦‰ì‹œ ì‘ë‹µ (LLM ìš°íšŒ)
            response = tool_result["result"]["message"]
        else:  # LLM-Interpreted
            # Gemma3ë¡œ í•´ì„
            response = await interpret_tool_result_with_llm(...)

    elif route_decision["route"] == "RAG_QUERY":
        # RAG Pipeline
        response = await rag_pipeline.query(...)

    else:  # SIMPLE_QA
        # Gemma3 ì§ì ‘ ì‘ë‹µ
        response = await simple_chat_with_llm(...)

    # 3. ì‘ë‹µ ë°˜í™˜ (route, used_tool ì •ë³´ ì¶”ê°€)
    return {
        "response": response,
        "route": route_decision["route"],
        "used_rag": used_rag,
        "used_tool": used_tool,
        "conversation_uuid": conversation_uuid,
        "response_time_ms": response_time_ms,
        "debug": debug_info
    }
```

**ì‘ë‹µ í˜•ì‹ ë³€ê²½**:
- ê¸°ì¡´: `{"response": str, "used_rag": bool, ...}`
- ìƒˆë¡œ: `{"response": str, "route": str, "used_rag": bool, "used_tool": str, ...}`

### êµ¬í˜„ ì™„ë£Œ ìƒíƒœ

#### Phase 1: íˆ´ ì‹œìŠ¤í…œ êµ¬ì¶• âœ…
- [x] êµ¬í˜„ ê³„íš ë¬¸ì„œ ì‘ì„± (`IMPLEMENTATION_PLAN.md`)
- [x] `tools.py`: íˆ´ ë² ì´ìŠ¤ í´ë˜ìŠ¤ ë° ë ˆì§€ìŠ¤íŠ¸ë¦¬
- [x] `tools.py`: 7ê°œ íˆ´ êµ¬í˜„ (ë…¸í‹°ë§Œ í‘œì‹œ)
- [x] `tool_executor.py`: íˆ´ ì‹¤í–‰ê¸°

#### Phase 2: ë¼ìš°í„° êµ¬ì¶• âœ…
- [x] `router.py`: IntelligentRouter í´ë˜ìŠ¤
- [x] `router.py`: Kanana í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
- [x] `router.py`: JSON íŒŒì‹± ë° ê²€ì¦

#### Phase 3: ì‹œìŠ¤í…œ í†µí•© âœ…
- [x] `main.py`: ë¼ìš°íŒ… ë¡œì§ ì—…ë°ì´íŠ¸
- [x] `main.py`: 3ê°€ì§€ ê²½ë¡œë³„ ì²˜ë¦¬
- [x] `agent.py`: ë°±ì—…ìš©ìœ¼ë¡œ ìœ ì§€ (ì¶”í›„ ì œê±° ê°€ëŠ¥)

#### Phase 4: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ âœ…
- [x] Python ë¬¸ë²• ì²´í¬ (ëª¨ë“  ëª¨ë“ˆ í†µê³¼)
- [x] ëª¨ë“ˆ êµ¬ì¡° ê²€ì¦
- [x] ì–¸ì–´ ë³€ê²½ íˆ´ í…ŒìŠ¤íŠ¸ ë° ë¬¸ì œ í•´ê²°
- [ ] ì‹¤ì œ ì„œë²„ ë™ì‘ í…ŒìŠ¤íŠ¸ (ì˜ˆì •)
- [ ] ë¼ìš°íŒ… ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (ì˜ˆì •)
- [ ] ì„±ëŠ¥ ì¸¡ì • (ì˜ˆì •)

---

## ğŸŒ ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ êµ¬í˜„ ë° ë¬¸ì œ í•´ê²°

### ë°°ê²½
ì‚¬ìš©ìê°€ ì±—ë´‡ì— "plz speak english"ì™€ ê°™ì´ ì…ë ¥í•˜ë©´ UI ì–¸ì–´ê°€ ìë™ìœ¼ë¡œ ë³€ê²½ë˜ë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.

### ë°œê²¬ëœ ë¬¸ì œ ë° í•´ê²° ê³¼ì •

#### ë¬¸ì œ 1: íŒŒë¼ë¯¸í„° ê²€ì¦ ì‹¤íŒ¨
**ì¦ìƒ**:
```
ì‚¬ìš©ì: "plz speak english"
â†’ íˆ´ ì½œë§: set_language âœ…
â†’ ì—ëŸ¬: "íŒŒë¼ë¯¸í„° ê²€ì¦ ì‹¤íŒ¨: í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½: language" âŒ
```

**ì›ì¸**:
- ë¼ìš°í„°ê°€ `set_language` íˆ´ì„ í˜¸ì¶œí•˜ê¸°ë¡œ ê²°ì •í–ˆì§€ë§Œ, `language` íŒŒë¼ë¯¸í„°ë¥¼ JSONì— í¬í•¨ì‹œí‚¤ì§€ ëª»í•¨
- `SetLanguageTool`ì—ì„œ `language` íŒŒë¼ë¯¸í„°ë¥¼ `required: True`ë¡œ ì„¤ì •í•´ì„œ íŒŒë¼ë¯¸í„° ì—†ì´ëŠ” ì‹¤í–‰ ë¶ˆê°€

**í•´ê²° ë°©ë²•**:
1. **`tools.py` - SetLanguageTool ê°œì„ **:
   ```python
   parameters = {
       "language": {
           "type": "string",
           "description": "ë³€ê²½í•  ì–¸ì–´ ì½”ë“œ. í•œêµ­ì–´=ko, ì˜ì–´/English=en, ì¼ë³¸ì–´/æ—¥æœ¬èª=ja, ì¤‘êµ­ì–´/ä¸­æ–‡=zh",
           "required": False,  # âœ… í•„ìˆ˜ â†’ ì„ íƒìœ¼ë¡œ ë³€ê²½
           "default": "en",     # âœ… ê¸°ë³¸ê°’ ì¶”ê°€
           "enum": ["ko", "en", "ja", "zh"]
       }
   }
   ```

2. **ì–¸ì–´ ì´ë¦„ â†’ ì½”ë“œ ìë™ ë³€í™˜**:
   ```python
   language_name_to_code = {
       "korean": "ko", "í•œêµ­ì–´": "ko", "korea": "ko",
       "english": "en", "ì˜ì–´": "en",
       "japanese": "ja", "ì¼ë³¸ì–´": "ja", "japan": "ja", "æ—¥æœ¬èª": "ja",
       "chinese": "zh", "ì¤‘êµ­ì–´": "zh", "china": "zh", "ä¸­æ–‡": "zh"
   }
   ```

3. **`router.py` - í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ ì¶”ê°€**:
   ```python
   ì‚¬ìš©ì: "plz speak english"
   ë‹µë³€: {"route": "TOOL_CALL", "tool_name": "set_language",
          "tool_params": {"language": "en"}, ...}
   ```

4. **íœ´ë¦¬ìŠ¤í‹± ë¼ìš°íŒ… ê°œì„ **:
   - í‚¤ì›Œë“œ í™•ì¥: `speak`, `language`, `korean`, `japanese`, `chinese` ì¶”ê°€
   - `set_language` íˆ´ì¸ ê²½ìš° íŒŒë¼ë¯¸í„° ìë™ ì¶”ì¶œ ë¡œì§ ì¶”ê°€

#### ë¬¸ì œ 2: í”„ë¡ íŠ¸ì—”ë“œ UI ì–¸ì–´ê°€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
**ì¦ìƒ**:
```
ì‚¬ìš©ì: "plz speak english"
â†’ íˆ´ ì‹¤í–‰: âœ… ì„±ê³µ
â†’ ì‘ë‹µ: "ì–¸ì–´ê°€ English(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤" âœ…
â†’ UI ì–¸ì–´: í•œêµ­ì–´ ê·¸ëŒ€ë¡œ âŒ
```

**ì›ì¸**:
- ë°±ì—”ë“œê°€ ì‘ë‹µì— ìš”ì²­ì˜ `language` ê°’ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜
- íˆ´ì´ ì‹¤ì œë¡œ ì‹¤í–‰í•œ ì–¸ì–´ ì½”ë“œë¥¼ ì‘ë‹µì— í¬í•¨ì‹œí‚¤ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
1. **`main.py` - íˆ´ ê²°ê³¼ì—ì„œ ì–¸ì–´ ì¶”ì¶œ**:
   ```python
   changed_language = None  # íˆ´ë¡œ ë³€ê²½ëœ ì–¸ì–´

   # set_language íˆ´ì¸ ê²½ìš° ë³€ê²½ëœ ì–¸ì–´ ì¶”ì¶œ
   if tool_name == "set_language" and tool_result.get("success"):
       changed_language = tool_result.get("result", {}).get("language")
       logger.info(f"ğŸŒ ì–¸ì–´ ë³€ê²½ ê°ì§€: {changed_language}")
   ```

2. **ì‘ë‹µ êµ¬ì„± ê°œì„ **:
   ```python
   # ì–¸ì–´ê°€ ë³€ê²½ëœ ê²½ìš° ë³€ê²½ëœ ì–¸ì–´ë¥¼ ë°˜í™˜
   if changed_language:
       response_data["language"] = changed_language
       response_data["language_changed"] = True  # âœ… ë³€ê²½ í”Œë˜ê·¸ ì¶”ê°€
   else:
       response_data["language"] = request.language
   ```

3. **`chat.html` - ì–¸ì–´ ë³€ê²½ ê°ì§€ ë¡œì§ ê°œì„ **:
   ```javascript
   // íˆ´ í˜¸ì¶œ ê²°ê³¼ í™•ì¸ (ì–¸ì–´ ë³€ê²½ íˆ´ì¸ ê²½ìš°)
   if (data.route === 'TOOL_CALL' && data.used_tool === 'set_language') {
       if (data.language_changed && data.language) {
           // ì–¸ì–´ê°€ ì‹¤ì œë¡œ ë³€ê²½ëœ ê²½ìš°
           console.log('ğŸŒ ì–¸ì–´ ë³€ê²½ ê°ì§€:', data.language);
           changeLanguage(data.language);  // âœ… UI ì–¸ì–´ ë³€ê²½
       }
   }
   ```

### ìµœì¢… ë™ì‘ íë¦„

```
ì‚¬ìš©ì: "plz speak english"
  â†“
ë¼ìš°í„° (Kanana):
  â†’ JSON íŒŒì‹± ì„±ê³µ: {"route": "TOOL_CALL", "tool_name": "set_language",
                     "tool_params": {"language": "en"}}
  ë˜ëŠ”
  â†’ JSON íŒŒì‹± ì‹¤íŒ¨: íœ´ë¦¬ìŠ¤í‹±ìœ¼ë¡œ íŒŒë¼ë¯¸í„° ìë™ ì¶”ì¶œ
  â†“
íˆ´ ì‹¤í–‰ê¸°: SetLanguageTool.execute(language="en")
  â†’ ì–¸ì–´ ì½”ë“œ ì •ê·œí™” (ì†Œë¬¸ì ë³€í™˜)
  â†’ ì–¸ì–´ ì´ë¦„ì´ë©´ ì½”ë“œë¡œ ë³€í™˜ ("english" â†’ "en")
  â†’ ê²°ê³¼: {"success": true, "result": {"language": "en", ...}}
  â†“
main.py: changed_language = "en" ì¶”ì¶œ
  â†“
ì‘ë‹µ ìƒì„±:
  {
    "response": "ì–¸ì–´ê°€ English(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤",
    "route": "TOOL_CALL",
    "used_tool": "set_language",
    "language": "en",  â† íˆ´ ê²°ê³¼ì—ì„œ ì¶”ì¶œ
    "language_changed": true  â† ë³€ê²½ í”Œë˜ê·¸
  }
  â†“
í”„ë¡ íŠ¸ì—”ë“œ: language_changed=true ê°ì§€
  â†“
changeLanguage("en") í˜¸ì¶œ
  â†“
UI ì „ì²´ê°€ ì˜ì–´ë¡œ ë³€ê²½! ğŸ‰
  - í—¤ë”: "Store Info Chatbot Test"
  - ë²„íŠ¼: "Send", "Generate Docs"
  - ì…ë ¥ì°½: "Enter message... (max 30 chars)"
  - ì„±ê³µ í† ìŠ¤íŠ¸: "Language changed to English"
```

### êµ¬í˜„ëœ ê¸°ëŠ¥

#### 1. í”„ë¡ íŠ¸ì—”ë“œ ë‹¤êµ­ì–´ ì§€ì› (`chat.html`)
**ì§€ì› ì–¸ì–´**: ğŸ‡°ğŸ‡· í•œêµ­ì–´, ğŸ‡ºğŸ‡¸ English, ğŸ‡¨ğŸ‡³ ä¸­æ–‡, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª

**ë²ˆì—­ëœ UI ìš”ì†Œ**:
- í—¤ë” ë° ì„œë¸Œíƒ€ì´í‹€
- ëª¨ë“  ë²„íŠ¼ (ë¬¸ì„œ ìƒì„±, ì¸ë±ì‹±, ì „ì†¡ ë“±)
- ë¼ë²¨ (ë§¤ì¥ ì„ íƒ, ì¹´í…Œê³ ë¦¬ ë“±)
- ì…ë ¥ í•„ë“œ í”Œë ˆì´ìŠ¤í™€ë”
- ì„¸ì…˜ ìƒíƒœ (ëŒ€í™” í™œì„±/ì¢…ë£Œ)
- ì—ëŸ¬ ë° ì„±ê³µ ë©”ì‹œì§€
- í† ìŠ¤íŠ¸ ì•Œë¦¼

**ì–¸ì–´ ë³€ê²½ ë°©ë²•**:
1. **ë²„íŠ¼ í´ë¦­**: ì„¤ì • ì˜ì—­ì˜ ì–¸ì–´ ë²„íŠ¼ í´ë¦­
2. **ì±—ë´‡ ëª…ë ¹**:
   - "plz speak english"
   - "ì–¸ì–´ë¥¼ í•œêµ­ì–´ë¡œ ë³€ê²½í•´ì¤˜"
   - "æ—¥æœ¬èªã§è©±ã—ã¦"
   - "æ”¹ä¸ºä¸­æ–‡"

**ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥**:
- ì„ íƒí•œ ì–¸ì–´ë¥¼ `localStorage`ì— ì €ì¥
- í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ì–¸ì–´ ì„¤ì • ìœ ì§€

#### 2. ë°±ì—”ë“œ ì–¸ì–´ ì²˜ë¦¬ (`main.py`, `tools.py`)
- `ChatRequest`ì— `language` íŒŒë¼ë¯¸í„° ì¶”ê°€
- `SetLanguageTool` íŒŒë¼ë¯¸í„° ìœ ì—°í™” (ê¸°ë³¸ê°’ ì œê³µ)
- ì–¸ì–´ ì´ë¦„ ìë™ ë³€í™˜ ("english" â†’ "en")
- ì‘ë‹µì— `language_changed` í”Œë˜ê·¸ í¬í•¨

#### 3. ë¼ìš°í„° ê°œì„  (`router.py`)
- ì–¸ì–´ ë³€ê²½ ê´€ë ¨ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ 5ê°œ ì¶”ê°€
- íœ´ë¦¬ìŠ¤í‹± í‚¤ì›Œë“œ í™•ì¥
- `set_language` íˆ´ íŒŒë¼ë¯¸í„° ìë™ ì¶”ì¶œ ë¡œì§

### í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ëª…ë ¹ì–´

#### ì˜ì–´ ë³€ê²½
- âœ… "plz speak english"
- âœ… "Can you speak English?"
- âœ… "ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ë°”ê¿”ì¤˜"
- âœ… "ì˜ì–´ë¡œ ë§í•´ì¤˜"
- âœ… "english please"

#### í•œêµ­ì–´ ë³€ê²½
- âœ… "í•œêµ­ì–´ë¡œ ë§í•´ì¤˜"
- âœ… "speak korean"
- âœ… "ì–¸ì–´ë¥¼ í•œêµ­ì–´ë¡œ ë³€ê²½"

#### ì¼ë³¸ì–´ ë³€ê²½
- âœ… "æ—¥æœ¬èªã§è©±ã—ã¦"
- âœ… "speak japanese"
- âœ… "ì¼ë³¸ì–´ë¡œ ë°”ê¿”ì¤˜"

#### ì¤‘êµ­ì–´ ë³€ê²½
- âœ… "ä¸­æ–‡"
- âœ… "speak chinese"
- âœ… "ì¤‘êµ­ì–´ë¡œ ë³€ê²½"

### ê°œì„  ì‚¬í•­ ìš”ì•½

| í•­ëª© | ì´ì „ | ì´í›„ |
|------|------|------|
| íŒŒë¼ë¯¸í„° ê²€ì¦ | í•„ìˆ˜, ì—†ìœ¼ë©´ ì‹¤íŒ¨ | ì„ íƒ, ê¸°ë³¸ê°’ ì œê³µ |
| ì–¸ì–´ ì½”ë“œ | ì½”ë“œë§Œ ì¸ì‹ ("en") | ì´ë¦„ë„ ì¸ì‹ ("english") |
| í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ | 0ê°œ | 5ê°œ (ì–¸ì–´ ê´€ë ¨) |
| íœ´ë¦¬ìŠ¤í‹± í‚¤ì›Œë“œ | 3ê°œ | 10ê°œ |
| íŒŒë¼ë¯¸í„° ì¶”ì¶œ | ë¼ìš°í„°ë§Œ | ë¼ìš°í„° + íœ´ë¦¬ìŠ¤í‹± |
| ì‘ë‹µ í”Œë˜ê·¸ | ì—†ìŒ | `language_changed` ì¶”ê°€ |
| UI ì—°ë™ | ìˆ˜ë™ | ìë™ (íˆ´ ì‹¤í–‰ ì‹œ) |

---

## ğŸ¤– LLM ë‹¤êµ­ì–´ ì‘ë‹µ ì‹œìŠ¤í…œ

### ë°°ê²½ ë° ìš”êµ¬ì‚¬í•­
í”„ë¡ íŠ¸ì—”ë“œ UI ì–¸ì–´ê°€ ë³€ê²½ë˜ë©´ LLMë„ ìë™ìœ¼ë¡œ í•´ë‹¹ ì–¸ì–´ë¡œ ì‘ë‹µí•´ì•¼ í•¨.
- í•œêµ­ì–´ UI â†’ LLM í•œêµ­ì–´ ì‘ë‹µ
- ì˜ì–´ UI â†’ LLM ì˜ì–´ ì‘ë‹µ
- ì¼ë³¸ì–´ UI â†’ LLM ì¼ë³¸ì–´ ì‘ë‹µ
- ì¤‘êµ­ì–´ UI â†’ LLM ì¤‘êµ­ì–´ ì‘ë‹µ

### êµ¬í˜„ ë°©ì‹

#### ì´ˆê¸° ì ‘ê·¼ (ë³µì¡)
ê° ì–¸ì–´ë³„ë¡œ ì „ì²´ í”„ë¡¬í”„íŠ¸ë¥¼ ë²ˆì—­:
```python
prompts = {
    "ko": f"""ë‹¹ì‹ ì€ ë§¤ì¥ì˜ ì¹œì ˆí•œ ì§ì›ì…ë‹ˆë‹¤.
ë‹µë³€ ê·œì¹™:
1. 50ì ì´ë‚´ë¡œ ê°„ê²°í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”
...(í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ ì „ì²´)""",

    "en": f"""You are a friendly store assistant.
Response rules:
1. Keep your answer concise, within 50 characters
...(ì˜ì–´ í”„ë¡¬í”„íŠ¸ ì „ì²´)""",

    # ja, zh ë™ì¼í•˜ê²Œ ì „ì²´ ë²ˆì—­
}
```

**ë¬¸ì œì **:
- í”„ë¡¬í”„íŠ¸ê°€ 4ë°°ë¡œ ì¦ê°€ (ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€)
- ë²ˆì—­ ì¼ê´€ì„± ë³´ì¥ ì–´ë ¤ì›€
- ì½”ë“œ ê°€ë…ì„± ì €í•˜

#### ìµœì¢… ì ‘ê·¼ (ê°„ì†Œí™”) âœ…
LLMì˜ ë‹¤êµ­ì–´ ì§€ì›ì„ í™œìš©í•˜ì—¬ ë‹¨ì¼ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ:
```python
language_instructions = {
    "ko": "í•œêµ­ì–´ë¡œ ë‹µë³€í•˜ì„¸ìš”.",
    "en": "Answer in English.",
    "ja": "æ—¥æœ¬èªã§ç­”ãˆã¦ãã ã•ã„ã€‚",
    "zh": "ç”¨ä¸­æ–‡å›ç­”ã€‚"
}

prompt = f"""You are a friendly store assistant.

Response rules:
1. Keep your answer concise, within 50 characters
2. Deliver only the key points the customer wants
3. Be kind but get to the point
4. Skip unnecessary explanations
5. **Important**: Never make up information you don't know
6. If uncertain, say "I'm not sure. Please ask a staff member for assistance"

**IMPORTANT: {language_instructions.get(language, language_instructions["ko"])}**

User: {user_message}
Assistant:"""
```

**ì¥ì **:
- âœ… í”„ë¡¬í”„íŠ¸ê°€ ë‹¨ì¼í™”ë˜ì–´ ìœ ì§€ë³´ìˆ˜ ìš©ì´
- âœ… ì½”ë“œ ê°„ê²°ì„± (100ì¤„ ì´ìƒ ê°ì†Œ)
- âœ… LLMì´ ìë™ìœ¼ë¡œ í•´ë‹¹ ì–¸ì–´ë¡œ ì‘ë‹µ
- âœ… ì¼ê´€ì„± ìˆëŠ” ë‹µë³€ í’ˆì§ˆ

### ìˆ˜ì •ëœ íŒŒì¼

#### 1. `main.py`
**`interpret_tool_result_with_llm()` í•¨ìˆ˜**:
- `language` íŒŒë¼ë¯¸í„° ì¶”ê°€
- ë‹¨ì¼ ì˜ì–´ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½
- ì–¸ì–´ë³„ "ë” ìì„¸íˆ ì„¤ëª…í•´ë“œë¦´ê¹Œìš”?" ë©”ì‹œì§€
- ì–¸ì–´ë³„ ì—ëŸ¬ ë©”ì‹œì§€

**`simple_chat_with_llm()` í•¨ìˆ˜**:
- `language` íŒŒë¼ë¯¸í„° ì¶”ê°€
- ë‹¨ì¼ ì˜ì–´ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½
- ì–¸ì–´ë³„ ì¶”ê°€ ì„¤ëª… ë©”ì‹œì§€
- ì–¸ì–´ë³„ ì—ëŸ¬ ë©”ì‹œì§€

**ê²½ë¡œë³„ language ì „ë‹¬**:
```python
# TOOL_CALL - LLM-Interpreted
response = await interpret_tool_result_with_llm(
    user_message=request.message,
    tool_name=tool_name,
    tool_result=tool_result["result"],
    language=changed_language if changed_language else request.language
)

# RAG_QUERY
response, rag_debug = await rag_pipeline.query(
    query=route_decision["query"],
    store_id=request.store_id,
    category=request.category,
    language=request.language
)

# SIMPLE_QA
response = await simple_chat_with_llm(
    route_decision["query"],
    language=request.language
)
```

#### 2. `rag_pipeline.py`
**`query()` í•¨ìˆ˜**:
- `language` íŒŒë¼ë¯¸í„° ì¶”ê°€
- ë‹¨ì¼ ì˜ì–´ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½
- ì–¸ì–´ë³„ "ë” ìì„¸íˆ ì„¤ëª…í•´ë“œë¦´ê¹Œìš”?" ë©”ì‹œì§€
- ì–¸ì–´ë³„ "ì œê°€ ì˜ ëª¨ë¥´ê² ì–´ìš”" ë©”ì‹œì§€ (ë¬¸ì„œ ì—†ìŒ ì‹œ)

```python
async def query(self, query: str, store_id: int, category: str = "customer", language: str = "ko"):
    # ì–¸ì–´ë³„ ì—ëŸ¬ ë©”ì‹œì§€
    no_info_messages = {
        "ko": "ì œê°€ ì˜ ëª¨ë¥´ê² ì–´ìš”. ì£„ì†¡í•˜ì§€ë§Œ ì§ì›ì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.",
        "en": "I'm not sure. Please ask a staff member for assistance.",
        "ja": "ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚¹ã‚¿ãƒƒãƒ•ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚",
        "zh": "æˆ‘ä¸å¤ªæ¸…æ¥šã€‚æŠ±æ­‰ï¼Œè¯·å‘å·¥ä½œäººå‘˜å’¨è¯¢ã€‚"
    }

    # í”„ë¡¬í”„íŠ¸ì— ì–¸ì–´ ì§€ì‹œ ì¶”ê°€
    prompt = f"""You are a friendly store assistant.
    ...
    **IMPORTANT: {language_instructions.get(language)}**
    ..."""
```

### ë™ì‘ íë¦„

```
1. ì‚¬ìš©ìê°€ UI ì–¸ì–´ ë³€ê²½ (ì˜ˆ: ì˜ì–´)
   â†“
2. localStorageì— "en" ì €ì¥
   â†“
3. ë‹¤ìŒ ë©”ì‹œì§€ ì „ì†¡ ì‹œ language="en" í¬í•¨
   â†“
4. ë°±ì—”ë“œê°€ ë¼ìš°íŒ… ê²°ì •
   â†“
5-1. TOOL_CALL (LLM-Interpreted):
     interpret_tool_result_with_llm(language="en")
     â†’ í”„ë¡¬í”„íŠ¸ì— "Answer in English" ì¶”ê°€
     â†’ Gemma3ê°€ ì˜ì–´ë¡œ ì‘ë‹µ

5-2. RAG_QUERY:
     rag_pipeline.query(language="en")
     â†’ í”„ë¡¬í”„íŠ¸ì— "Answer in English" ì¶”ê°€
     â†’ Gemma3ê°€ ì˜ì–´ë¡œ ì‘ë‹µ

5-3. SIMPLE_QA:
     simple_chat_with_llm(language="en")
     â†’ í”„ë¡¬í”„íŠ¸ì— "Answer in English" ì¶”ê°€
     â†’ Gemma3ê°€ ì˜ì–´ë¡œ ì‘ë‹µ
     â†“
6. ì‚¬ìš©ìì—ê²Œ ì˜ì–´ë¡œ ë‹µë³€ ì „ë‹¬ âœ…
```

### ì±„íŒ… UI ë°°ì§€ ê°œì„ 

#### ìš”êµ¬ì‚¬í•­
ê¸°ì¡´ì—ëŠ” "ì¼ë°˜"ê³¼ "RAG" 2ê°€ì§€ ë°°ì§€ë§Œ í‘œì‹œë˜ì—ˆìœ¼ë‚˜, íˆ´ í˜¸ì¶œ ì‹œ "íˆ´" ë°°ì§€ë„ í‘œì‹œí•´ì•¼ í•¨.

#### êµ¬í˜„ ë‚´ìš©

**`chat.html` - translations ì¶”ê°€**:
```javascript
const translations = {
    ko: {
        // ... ê¸°ì¡´ ë²ˆì—­
        badgeTool: "ğŸ”§ íˆ´",
        badgeRag: "ğŸ“š RAG",
        badgeSimple: "ğŸ’¬ ì¼ë°˜"
    },
    en: {
        badgeTool: "ğŸ”§ Tool",
        badgeRag: "ğŸ“š RAG",
        badgeSimple: "ğŸ’¬ Simple"
    },
    zh: {
        badgeTool: "ğŸ”§ å·¥å…·",
        badgeRag: "ğŸ“š RAG",
        badgeSimple: "ğŸ’¬ ç®€å•"
    },
    ja: {
        badgeTool: "ğŸ”§ ãƒ„ãƒ¼ãƒ«",
        badgeRag: "ğŸ“š RAG",
        badgeSimple: "ğŸ’¬ é€šå¸¸"
    }
};
```

**`addMessage()` í•¨ìˆ˜ ê°œì„ **:
```javascript
function addMessage(text, type, usedRag = null, route = null, usedTool = null) {
    const t = translations[currentLanguage];
    let badgeHtml = '';

    // ë°°ì§€ í‘œì‹œ ìš°ì„ ìˆœìœ„: TOOL_CALL > RAG_QUERY > SIMPLE_QA
    if (route === 'TOOL_CALL' && usedTool) {
        // íˆ´ í˜¸ì¶œì¸ ê²½ìš°
        badgeHtml = `<div class="message-badge">${t.badgeTool}</div>`;
    } else if (usedRag === true) {
        // RAG ì‚¬ìš©í•œ ê²½ìš°
        badgeHtml = `<div class="message-badge">${t.badgeRag}</div>`;
    } else if (type === 'assistant' && (route === 'SIMPLE_QA' || usedRag === false)) {
        // ì¼ë°˜ ëŒ€í™”ì¸ ê²½ìš°
        badgeHtml = `<div class="message-badge">${t.badgeSimple}</div>`;
    }

    // ...
}
```

#### ë°°ì§€ í‘œì‹œ ê·œì¹™

| ì¡°ê±´ | ë°°ì§€ | í•œêµ­ì–´ | English | ä¸­æ–‡ | æ—¥æœ¬èª |
|------|------|--------|---------|------|--------|
| `route === 'TOOL_CALL' && usedTool` | íˆ´ | ğŸ”§ íˆ´ | ğŸ”§ Tool | ğŸ”§ å·¥å…· | ğŸ”§ ãƒ„ãƒ¼ãƒ« |
| `usedRag === true` | RAG | ğŸ“š RAG | ğŸ“š RAG | ğŸ“š RAG | ğŸ“š RAG |
| `route === 'SIMPLE_QA'` ë˜ëŠ” `usedRag === false` | ì¼ë°˜ | ğŸ’¬ ì¼ë°˜ | ğŸ’¬ Simple | ğŸ’¬ ç®€å• | ğŸ’¬ é€šå¸¸ |

#### ê²°ê³¼
- âœ… íˆ´ í˜¸ì¶œ ì‹œ "ğŸ”§ íˆ´" ë°°ì§€ í‘œì‹œ
- âœ… RAG ì‚¬ìš© ì‹œ "ğŸ“š RAG" ë°°ì§€ í‘œì‹œ
- âœ… ì¼ë°˜ ëŒ€í™” ì‹œ "ğŸ’¬ ì¼ë°˜" ë°°ì§€ í‘œì‹œ
- âœ… ì„ íƒëœ ì–¸ì–´ì— ë§ì¶° ë°°ì§€ í…ìŠ¤íŠ¸ ìë™ ë³€ê²½

### ê°œì„  ì‚¬í•­ ìš”ì•½

| í•­ëª© | ì´ì „ | ì´í›„ |
|------|------|------|
| í”„ë¡¬í”„íŠ¸ êµ¬ì¡° | ì–¸ì–´ë³„ ì „ì²´ ë²ˆì—­ (4ë°°) | ë‹¨ì¼ í”„ë¡¬í”„íŠ¸ + ì–¸ì–´ ì§€ì‹œ |
| ì½”ë“œ ë¼ì¸ ìˆ˜ | ~200ì¤„ (í”„ë¡¬í”„íŠ¸) | ~50ì¤„ (ê°„ì†Œí™”) |
| ìœ ì§€ë³´ìˆ˜ì„± | ì–´ë ¤ì›€ (4ê°œ ë™ê¸°í™”) | ì‰¬ì›€ (1ê°œë§Œ ê´€ë¦¬) |
| LLM ì‘ë‹µ ì–¸ì–´ | UI ì–¸ì–´ì™€ ë¬´ê´€ | UI ì–¸ì–´ì— ë§ì¶° ìë™ ë³€ê²½ âœ… |
| ë°°ì§€ ì¢…ë¥˜ | 2ê°€ì§€ (ì¼ë°˜/RAG) | 3ê°€ì§€ (ì¼ë°˜/RAG/íˆ´) âœ… |
| ë°°ì§€ ë‹¤êµ­ì–´ | ë¯¸ì§€ì› | 4ê°œ ì–¸ì–´ ì§€ì› âœ… |

---

## ğŸ¯ ì‹œìŠ¤í…œ íŠ¹ì§• ë° ì¥ì 

### 1. ì†ë„ ìµœì í™”
- **Self-Contained íˆ´**: LLM í˜¸ì¶œ ìš°íšŒ â†’ 10-50ms (ê¸°ì¡´ 200-500ms)
- **ì˜ˆìƒ ê°œì„ **: ê°„ë‹¨í•œ ì‘ì—…ì—ì„œ 80-90% ì†ë„ í–¥ìƒ

### 2. í’ˆì§ˆ ë³´ì¥
- **LLM-Interpreted íˆ´**: ë³µì¡í•œ ë°ì´í„°ë„ ìì—°ì–´ë¡œ ì •í™•íˆ í•´ì„
- **RAG Pipeline**: ë§¤ì¥ ì •ë³´ëŠ” ë¬¸ì„œ ê¸°ë°˜ìœ¼ë¡œ ì •í™•í•œ ë‹µë³€

### 3. í™•ì¥ì„±
- ìƒˆë¡œìš´ íˆ´ ì¶”ê°€ê°€ ë§¤ìš° ì‰¬ì›€:
  1. `tools.py`ì— ìƒˆ í´ë˜ìŠ¤ ì¶”ê°€
  2. `ToolRegistry`ì— ìë™ ë“±ë¡
  3. ë¼ìš°í„°ê°€ ìë™ìœ¼ë¡œ ì¸ì‹

### 4. ì•ˆì •ì„±
- JSON íŒŒì‹± ì‹¤íŒ¨ â†’ íœ´ë¦¬ìŠ¤í‹± ë¼ìš°íŒ…
- íˆ´ ì‹¤í–‰ ì‹¤íŒ¨ â†’ ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜
- ì „ì²´ ì‹œìŠ¤í…œ ì‹¤íŒ¨ â†’ SIMPLE_QAë¡œ fallback

### 5. ëª¨ë‹ˆí„°ë§
- ê° ê²½ë¡œë³„ ì‚¬ìš© í†µê³„ ì¶”ì  ê°€ëŠ¥
- íˆ´ ì‹¤í–‰ ì´ë ¥ ë¡œê¹…
- ë¼ìš°í„° confidence ìŠ¤ì½”ì–´ ê¸°ë¡

---

## ğŸ“š ì£¼ìš” íŒŒì¼ êµ¬ì¡° (ì—…ë°ì´íŠ¸)

```
rag-server/
â”œâ”€â”€ main.py                    # FastAPI ë©”ì¸ âœ… ìˆ˜ì • ì™„ë£Œ
â”œâ”€â”€ agent.py                   # ê¸°ì¡´ Agent (ë°±ì—…ìš© ìœ ì§€)
â”œâ”€â”€ router.py                  # ì§€ëŠ¥í˜• ë¼ìš°í„° âœ… ì‹ ê·œ
â”œâ”€â”€ tools.py                   # íˆ´ ì •ì˜ ë° ë ˆì§€ìŠ¤íŠ¸ë¦¬ âœ… ì‹ ê·œ
â”œâ”€â”€ tool_executor.py           # íˆ´ ì‹¤í–‰ê¸° âœ… ì‹ ê·œ
â”œâ”€â”€ rag_pipeline.py            # RAG Pipeline (ìœ ì§€)
â”œâ”€â”€ embeddings.py              # ì„ë² ë”© (ìœ ì§€)
â”œâ”€â”€ vector_store.py            # ë²¡í„° ìŠ¤í† ì–´ (ìœ ì§€)
â”œâ”€â”€ document_loader.py         # ë¬¸ì„œ ë¡œë” (ìœ ì§€)
â”œâ”€â”€ document_generator.py      # ë¬¸ì„œ ìƒì„±ê¸° (ìœ ì§€)
â”œâ”€â”€ conversation_service.py    # ëŒ€í™” ì„œë¹„ìŠ¤ (ìœ ì§€)
â”œâ”€â”€ conversation_logger.py     # ë¹„ë™ê¸° ë¡œê±° (ìœ ì§€)
â”œâ”€â”€ encryption_utils.py        # ì•”í˜¸í™” (ìœ ì§€)
â”œâ”€â”€ tasks.py                   # Celery ì‘ì—… (ìœ ì§€)
â”œâ”€â”€ worker.py                  # Celery Worker (ìœ ì§€)
â”œâ”€â”€ IMPLEMENTATION_PLAN.md     # êµ¬í˜„ ê³„íš ë¬¸ì„œ âœ…
â”œâ”€â”€ CLAUDE.md                  # ì´ ë¬¸ì„œ âœ…
â””â”€â”€ templates/
    â””â”€â”€ chat.html              # í…ŒìŠ¤íŠ¸ìš© ì›¹ UI
```

---

## ğŸ”§ ê°œë°œ í™˜ê²½

### ëª¨ë¸ ì •ë³´
- **ë¼ìš°í„° (Kanana)**: `huihui_ai/kanana-nano-abliterated:2.1b`
  - URL: `http://112.148.37.41:1889`
  - ì—­í• : ê²½ë¡œ ê²°ì • (TOOL_CALL/RAG_QUERY/SIMPLE_QA)
- **ë©”ì¸ LLM (Gemma3)**: `gemma3:27b-it-q4_K_M`
  - URL: `http://112.148.37.41:1884`
  - ì—­í• : ìì—°ì–´ ì‘ë‹µ ìƒì„±, íˆ´ ê²°ê³¼ í•´ì„

### ì£¼ìš” ì˜ì¡´ì„±
- FastAPI
- Ollama (LLM í´ë¼ì´ì–¸íŠ¸)
- Milvus (ë²¡í„° DB)
- Redis (í)
- SQLAlchemy (ORM)

### ì‹¤í–‰ ë°©ë²•
```bash
cd rag-server
python main.py
# ë˜ëŠ”
uvicorn main:app --host 0.0.0.0 --port 8002
```

---

## ğŸ“ ë‹¤ìŒ ì„¸ì…˜ì—ì„œ í•  ì¼

### ì¦‰ì‹œ ì‹œì‘í•  ì‘ì—…

#### 1. ì‹¤ì œ ì„œë²„ ë™ì‘ í…ŒìŠ¤íŠ¸
```bash
cd /home/wk/projects/wafl/rag-server
python main.py
```

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**:
- [ ] "ê¹€ì¹˜ì°Œê°œ ì£¼ë¬¸í•´ì¤˜" â†’ TOOL_CALL (Self-Contained)
- [ ] "ì˜¤ëŠ˜ ë§¤ì¶œ ì•Œë ¤ì¤˜" â†’ TOOL_CALL (LLM-Interpreted)
- [ ] "ì˜ì—…ì‹œê°„ ì•Œë ¤ì¤˜" â†’ RAG_QUERY
- [ ] "ì•ˆë…•í•˜ì„¸ìš”" â†’ SIMPLE_QA
- [x] "plz speak english" â†’ TOOL_CALL (set_language) âœ… ì™„ë£Œ

**í™•ì¸ ì‚¬í•­**:
- ë¼ìš°í„° JSON ì‘ë‹µ ì •ìƒ íŒŒì‹±
- ê° ê²½ë¡œë³„ ì²˜ë¦¬ ì •ìƒ ë™ì‘
- ì—ëŸ¬ í•¸ë“¤ë§ ë™ì‘ í™•ì¸
- ì‘ë‹µ ì‹œê°„ ì¸¡ì •

#### 2. íˆ´ ì‹¤ì œ ë™ì‘ êµ¬í˜„ (ìš°ì„ ìˆœìœ„ë³„)

**High Priority**:
- `OrderMenuTool`: DBì— ì£¼ë¬¸ ì €ì¥
- `GetSalesDataTool`: ì‹¤ì œ DBì—ì„œ ë§¤ì¶œ ì¡°íšŒ

**Medium Priority**:
- ~~`SetLanguageTool`: ì„¸ì…˜ì— ì–¸ì–´ ì„¤ì • ì €ì¥~~ âœ… ì™„ë£Œ (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë°©ì‹)
- `GetOrderStatisticsTool`: ì‹¤ì œ ì£¼ë¬¸ í†µê³„ ì¡°íšŒ

**Low Priority**:
- `NavigateToTool`: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™
- `ApplyFilterTool`: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™
- `AnalyzeTrendsTool`: ê³ ê¸‰ ë¶„ì„ ë¡œì§

#### 3. ëª¨ë‹ˆí„°ë§ ë° ìµœì í™”
- ë¼ìš°í„° ì •í™•ë„ ì¸¡ì •
  - ê° ê²½ë¡œë³„ ì •í™•ë„
  - JSON íŒŒì‹± ì‹¤íŒ¨ìœ¨
  - Fallback ë°œë™ ë¹„ìœ¨
- ì‘ë‹µ ì‹œê°„ ì¸¡ì •
  - Self-Contained vs LLM-Interpreted
  - ê¸°ì¡´ ì‹œìŠ¤í…œ ëŒ€ë¹„ ê°œì„ ìœ¨
- A/B í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ êµ¬ì¶•

#### 4. ë¬¸ì„œ ì—…ë°ì´íŠ¸
- API ë¬¸ì„œ ì—…ë°ì´íŠ¸ (Swagger/OpenAPI)
- íˆ´ ì¶”ê°€ ê°€ì´ë“œ ì‘ì„±
- íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

---

## ğŸ’¡ ì¤‘ìš” ì„¤ê³„ ì›ì¹™

### 1. íˆ´ ì‹¤í–‰ ë…¸í‹° (í˜„ì¬ êµ¬í˜„ ìƒíƒœ)
- **í˜•ì‹**: `"âœ… [íˆ´ ì‹¤í–‰] {tool_name} - {params}"`
- **ì´ìœ **: ì‹œìŠ¤í…œ êµ¬ì¡° ë¨¼ì € êµ¬ì¶•, ì‹¤ì œ ë™ì‘ì€ ë‹¨ê³„ì  êµ¬í˜„
- **ì¥ì **: ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

### 2. ë¼ìš°í„° ì•ˆì •ì„±
- JSON íŒŒì‹± ì‹¤íŒ¨ â†’ íœ´ë¦¬ìŠ¤í‹± ë¼ìš°íŒ…
- íœ´ë¦¬ìŠ¤í‹± ì‹¤íŒ¨ â†’ SIMPLE_QA (í•­ìƒ ì‘ë‹µ ê°€ëŠ¥)
- ëª¨ë“  ë‹¨ê³„ì—ì„œ ìƒì„¸ ë¡œê¹…

### 3. ì„±ëŠ¥ ìµœì í™”
- Self-Contained íˆ´: LLM ìš°íšŒ (ì†ë„ ìš°ì„ )
- LLM-Interpreted íˆ´: Gemma3 ì‚¬ìš© (í’ˆì§ˆ ìš°ì„ )
- ë¹„ë™ê¸° ì²˜ë¦¬: ëŒ€í™” ì €ì¥ ë“± ë¶€ê°€ ì‘ì—…

### 4. í™•ì¥ì„±
- ìƒˆ íˆ´ ì¶”ê°€: `tools.py`ì—ë§Œ ì‘ì„±
- ìƒˆ ê²½ë¡œ ì¶”ê°€: ë¼ìš°í„° í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
- ë ˆê±°ì‹œ í˜¸í™˜: ê¸°ì¡´ Agent ë°±ì—… ìœ ì§€

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### ìš´ì˜ í™˜ê²½ ë°°í¬ ì‹œ
1. **í™˜ê²½ ë³€ìˆ˜ í™•ì¸**:
   - `OLLAMA_AGENT_URL`: Kanana ëª¨ë¸ URL
   - `OLLAMA_MAIN_URL`: Gemma3 ëª¨ë¸ URL
   - `DATABASE_URL`: PostgreSQL ì—°ê²° ì •ë³´

2. **ì˜ì¡´ì„± ì„¤ì¹˜**:
   ```bash
   pip install -r requirements.txt
   ```

3. **ê¸°ì¡´ Agent ë°±ì—…**:
   - `agent.py`ëŠ” ì‚­ì œí•˜ì§€ ë§ ê²ƒ
   - ë¼ìš°í„° ë¬¸ì œ ì‹œ ë¡¤ë°± ê°€ëŠ¥

4. **ì ì§„ì  ë°°í¬**:
   - ì²˜ìŒì—ëŠ” ì¼ë¶€ ì‚¬ìš©ìë§Œ ìƒˆ ì‹œìŠ¤í…œ ì‚¬ìš©
   - ë¡œê·¸ ëª¨ë‹ˆí„°ë§í•˜ë©° ì ì§„ì  í™•ëŒ€
   - ë¬¸ì œ ë°œìƒ ì‹œ ì¦‰ì‹œ ê¸°ì¡´ ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜

### ê°œë°œ ì‹œ
1. **ë¡œê·¸ í™•ì¸ í•„ìˆ˜**:
   - ë¼ìš°í„° íŒë‹¨ ê²°ê³¼
   - íˆ´ ì‹¤í–‰ ê²°ê³¼
   - ì—ëŸ¬ ë°œìƒ ì—¬ë¶€

2. **í…ŒìŠ¤íŠ¸ ìš°ì„ **:
   - ìƒˆ íˆ´ ì¶”ê°€ ì‹œ ë°˜ë“œì‹œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
   - ë¼ìš°í„° í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ì‹œ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸

3. **ì—ëŸ¬ í•¸ë“¤ë§**:
   - ëª¨ë“  íˆ´ì€ ì—ëŸ¬ ë°œìƒ ì‹œ êµ¬ì²´ì  ë©”ì‹œì§€ ë°˜í™˜
   - ì‚¬ìš©ìì—ê²ŒëŠ” ì¹œì ˆí•œ ë©”ì‹œì§€, ë¡œê·¸ì—ëŠ” ìƒì„¸ ì •ë³´

---

## ğŸ’¬ ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸

### í”„ë¡œì íŠ¸ íˆìŠ¤í† ë¦¬
- **ìµœê·¼ ì‘ì—…**:
  - "feat: LLM íˆ´ í˜¸ì¶œ ì ì‘í˜• ë¼ìš°íŒ… ì‹œìŠ¤í…œ êµ¬í˜„"
  - "feat: ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ ë° ë‹¤êµ­ì–´ ì§€ì› (4ê°œ ì–¸ì–´)"
- **ìµœê·¼ ì»¤ë°‹**: "feat: RAG ëŒ€í™” ë¹„ë™ê¸° ë¡œê¹… ì‹œìŠ¤í…œ êµ¬í˜„"
- **ë¸Œëœì¹˜**: main
- **ìƒíƒœ**: êµ¬í˜„ ì™„ë£Œ (ì»¤ë°‹ ëŒ€ê¸°)

### ê°œë°œ ìŠ¤íƒ€ì¼
- í•œê¸€ ì£¼ì„ ë° ë¡œê·¸ ë©”ì‹œì§€
- ë¡œê¹… ë ˆë²¨: INFO
- ì‘ë‹µ ê¸¸ì´ ì œí•œ: 50ì (í•„ìš”ì‹œ í™•ì¥ ì œì•ˆ)
- ì—ëŸ¬ ë©”ì‹œì§€: ì‚¬ìš©ì ì¹œí™”ì  + ìƒì„¸ ë¡œê¹…

### ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤
- [x] ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸ âœ…
- [x] í”„ë¡ íŠ¸ì—”ë“œ ë‹¤êµ­ì–´ ì§€ì› (4ê°œ ì–¸ì–´) âœ…
- [ ] ì‹¤ì œ ì„œë²„ í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…
- [ ] ë‚˜ë¨¸ì§€ íˆ´ ì‹¤ì œ ë™ì‘ êµ¬í˜„ (DB ì—°ë™)
- [ ] ì„±ëŠ¥ ì¸¡ì • ë° ìµœì í™”
- [ ] A/B í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬

---

## ğŸ“ ì°¸ê³  ì •ë³´

### ê´€ë ¨ ë¬¸ì„œ
- `IMPLEMENTATION_PLAN.md`: ìƒì„¸ êµ¬í˜„ ê³„íš (ì™„ë£Œ)
- `CLAUDE.md`: ì´ ë¬¸ì„œ (ìµœì‹ )
- Git ì»¤ë°‹ ë¡œê·¸: í”„ë¡œì íŠ¸ íˆìŠ¤í† ë¦¬

### ë‹¤ìŒ ì‘ì—… ì‹œì‘ ëª…ë ¹ì–´
```
CLAUDE.md íŒŒì¼ì„ ì½ê³  ì‹¤ì œ ì„œë²„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì¤˜.
í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ì— ë”°ë¼ ê° ê²½ë¡œê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ ,
ë¬¸ì œê°€ ìˆìœ¼ë©´ ìˆ˜ì •í•´ì¤˜.
```

ë˜ëŠ”

```
tools.pyì—ì„œ OrderMenuToolì˜ ì‹¤ì œ ë™ì‘ì„ êµ¬í˜„í•´ì¤˜.
DBì— ì£¼ë¬¸ì„ ì €ì¥í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•˜ê³ ,
ì‹¤ì œ ì£¼ë¬¸ì´ ì €ì¥ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ì¤˜.
```

---

## ğŸ“Š êµ¬í˜„ í†µê³„

- **ì´ ì½”ë“œ ë¼ì¸ ìˆ˜**: ~2,100ì¤„
  - `tools.py`: 500ì¤„ (ì–¸ì–´ ë³€í™˜ ë¡œì§ ì¶”ê°€)
  - `tool_executor.py`: 200ì¤„
  - `router.py`: 380ì¤„ (íœ´ë¦¬ìŠ¤í‹± ê°œì„ )
  - `main.py`: 577ì¤„ (ì–¸ì–´ë³„ LLM ì‘ë‹µ ì¶”ê°€)
  - `rag_pipeline.py`: 220ì¤„ (ì–¸ì–´ë³„ RAG ì‘ë‹µ ì¶”ê°€)
  - `chat.html`: ~920ì¤„ (ë°°ì§€ ë‹¤êµ­ì–´ ì§€ì›)
- **ì´ ê°œë°œ ì‹œê°„**: ì•½ 5ì‹œê°„
- **í…ŒìŠ¤íŠ¸ ì™„ë£Œ**:
  - âœ… ë¬¸ë²• ì²´í¬
  - âœ… ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
  - âœ… LLM ë‹¤êµ­ì–´ ì‘ë‹µ ë¡œì§ êµ¬í˜„
  - âœ… UI ë°°ì§€ ì‹œìŠ¤í…œ ê°œì„ 
- **ì‹¤ì„œë²„ í…ŒìŠ¤íŠ¸**: ë¶€ë¶„ ì™„ë£Œ (ì–¸ì–´ ë³€ê²½)

---

> **ì‘ì„±ì**: Claude Code ì„¸ì…˜ (2025-10-07)
>
> **ëª©ì **: ì‘ì—… ì»¨í…ìŠ¤íŠ¸ ìœ ì§€ ë° ì—°ì†ì„± ìˆëŠ” ê°œë°œ ì§€ì›
>
> **ìƒíƒœ**:
> - LLM íˆ´ í˜¸ì¶œ ì ì‘í˜• ë¼ìš°íŒ… ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ âœ…
> - ì–¸ì–´ ë³€ê²½ ê¸°ëŠ¥ ë° ë‹¤êµ­ì–´ ì§€ì› (4ê°œ ì–¸ì–´) ì™„ë£Œ âœ…
> - LLM ë‹¤êµ­ì–´ ì‘ë‹µ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ âœ…
> - UI ë°°ì§€ ì‹œìŠ¤í…œ ê°œì„  (ì¼ë°˜/RAG/íˆ´) ì™„ë£Œ âœ…
